@model System.Data.DataTable

@Html.DevExpress().GridView(
    settings =>
    {
        settings.Name = "GridView";
        settings.CallbackRouteValues = new { Controller = "RP01V2", Action = "GridView" };
        settings.CustomActionRouteValues = new { Controller = "RP01V2", Action = "GridViewRefreshData" };
        settings.ClientSideEvents.BeginCallback = "GridViewBegCallback";
        settings.Styles.Header.BackColor = System.Drawing.ColorTranslator.FromHtml("#e9e9e9");
        settings.Styles.Header.ForeColor = System.Drawing.ColorTranslator.FromHtml("#0076c2");
        settings.Columns.Add(
            column =>
            {
                column.FieldName = "PUR_NO";
                column.Caption = "採購單號";
            });
        settings.Columns.Add(
            column =>
            {
                column.FieldName = "PUR_DT";
                column.Caption = "採購日期";
            });
        settings.Columns.Add(
            column =>
            {
                column.FieldName = "INC_NM";
                column.Caption = "廠商名稱";
            });
        settings.Columns.Add(
            column =>
            {
                column.FieldName = "PUR_PR";
                column.Caption = "採購單價";
                column.EditorProperties().SpinEdit(s =>
                {
                    s.DecimalPlaces = 2;
                    s.DisplayFormatString = "G29";
                });
            });
        settings.Columns.Add(
            column =>
            {
                column.FieldName = "Each_PR";
                column.Caption = "到貨單價";
                column.EditorProperties().SpinEdit(s =>
                {
                    s.DecimalPlaces = 2;
                    s.DisplayFormatString = "G29";
                });
            });
        settings.Columns.Add(
            column =>
            {
                column.FieldName = "PUR_QT";
                column.Caption = "採購數量";
                column.EditorProperties().SpinEdit(s =>
                {
                    s.DecimalPlaces = 2;
                    s.DisplayFormatString = "G29";
                });
            });
        settings.Columns.Add(
            column =>
            {
                column.FieldName = "TOT_QT";
                column.Caption = "到貨數量";
                column.EditorProperties().SpinEdit(s =>
                {
                    s.DecimalPlaces = 2;
                    s.DisplayFormatString = "G29";
                });
            });
        settings.HtmlDataCellPrepared = (s, e) =>
        {
            if (e.DataColumn.FieldName == "TOT_QT")
            {
                var ss = s as MVCxGridView;
                var cellValue = ss.GetRowValues(e.VisibleIndex, "PUR_QT") as decimal?;
                var currentCell = e.CellValue as decimal?;
                if (cellValue.HasValue && currentCell.HasValue)
                {
                    if (Decimal.Compare(cellValue.Value, currentCell.Value) != 0)
                    {
                        e.Cell.ForeColor = System.Drawing.Color.Red;
                    }
                }
            }
        };

    }).Bind(Model).GetHtml()
